<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout.html}" lang="en">
<div class="container-fluid text-white p-5 transparent-theme" layout:fragment="content">
    <link rel="stylesheet" href="/css/transparent-theme.css">
    <section class="page-section">
        <div class="container">
            <h2 class="text-center mt-0">⭐ 리뷰 목록</h2>
            <hr class="divider my-4" />

            <!-- 검색 -->
            <form method="get" th:action="@{/reviews/list/{id}(id=${recipeId})}" class="d-flex align-items-center mb-4" style="gap: 8px;">
                <select name="searchType" class="form-select" style="width: 120px; height: 36px; font-size: 14px;">
                    <option value="content">내용</option>
                    <option value="writer">작성자</option>
                </select>
                <input type="text" name="keyword" class="form-control" placeholder="검색어 입력" style="height: 36px; font-size: 14px;">
                <button type="submit" class="btn btn-primary" style="height: 36px; width: 80px; font-size: 14px;">검색</button>
            </form>

            <!-- 리뷰 목록 -->
            <div class="row g-4 card-grid">
                <div class="col-12 col-sm-6 col-md-4 col-lg-3" th:each="review : ${reviewList}">
                    <div class="card h-100 shadow-sm border-0 bg-transparent text-white">
                        <div th:if="${review.imagePath != null}">
                            <img th:src="@{${review.imagePath}}" class="card-img-top" alt="리뷰 이미지"
                                 style="height: 160px; object-fit: contain;" />
                        </div>
                        <div th:unless="${review.imagePath != null}" class="card-img-top bg-secondary d-flex align-items-center justify-content-center" style="height: 160px;">
                            <i class="bi bi-card-text" style="font-size: 2rem;"></i>
                        </div>
                        <div class="card-body p-2">
                            <div class="d-flex justify-content-between align-items-center mb-1">
                                <span class="badge bg-primary" th:text="${review.recipe.title}">레시피 제목</span>
                                <span class="text-warning" th:text="${'★ ' + review.rating}">★ 5</span>
                            </div>
                            <p class="text-muted mb-1" style="font-size: 0.85rem;">
                                <span class="text-white" th:text="${review.buyer.username}">작성자</span> |
                                <span class="text-white" th:text="${#temporals.format(review.createdAt, 'MM/dd')}">등록일</span> |
                                <span class="text-white" th:text="'❤️ ' + ${review.likesCount}">좋아요수</span>
                            </p>
                        </div>
                        <div class="card-footer text-center bg-transparent border-0">
                            <a th:href="@{/reviews/view/{id}(id=${review.id})}" class="btn btn-secondary btn-sm w-100">자세히 보기</a>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-4 text-center" th:if="${recipeId != null}">
                <a th:href="@{/reviews/register/{id}(id=${recipeId})}" class="btn btn-primary btn-lg">➕ 리뷰 작성하기</a>
            </div>
        </div>
    </section>
</div>
</html>
